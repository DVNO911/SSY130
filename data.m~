% File containing measured data for project 2 as well as plots
clc, clear all, close all, beep off
%% hBB (300 taps)
hBB = flip([.00228142;
        .000638575;
        .000413015;
        .000656479;
        .000843131;
        -.000542719;
        -.00175169;
        -.00204723;
        -.0018547;
        -.0022209;
        -.00263936;
        -.00303372;
        -.00270217;
        -.00201703;
        -.00144008;
        -.0010609;
        -.00090479;
        -.000885886;
        -.000666563;
        -.000530761;
        -.000268103;
        -.00021035;
        -.000332481;
        -.000414238;
        -.000124663;
        -.00010062;
        .000179209;
        3.22302e-5;
        -.000514508;
        -.00096154;
        -.00120864;
        -.00149045;
        -.00112629;
        -.000676292;
        -6.33981e-5;
        .000921341;
        .00129629;
        .000303849;
        -.000554309;
        -.000734184;
        -.00060351;
        -.000437477;
        -.000183911;
        -.00129858;
        -.00152772;
        -.000925748;
        -7.89448e-5;
        -.000343012;
        -.000757168;
        -.00124504;
        -.000800762;
        .00148688;
        .00223739;
        .00121127;
        -.000177876;
        8.08407e-5;
        .00080165;
        .00101163;
        -6.3693e-5;
        -.00114496;
        -.00100671;
        -.000290942;
        .000276577;
        .000927455;
        .00033744;
        .000115923;
        .00129861;
        .0020257;
        .00164546;
        .000143873;
        -.00140176;
        -.00190232;
        -.000324935;
        .000785929;
        6.08021e-5;
        -.000767993;
        -.000438781;
        -.000340198;
        -.000434913;
        -.00100236;
        -.00145209;
        -.000159958;
        .00075655;
        .00032637;
        -.000549354;
        -.00135546;
        -.00227986;
        -.00141656;
        -.000609664;
        -.00095499;
        -.00121517;
        -.000919776;
        -.000627387;
        -.000746724;
        .000217128;
        .000619566;
        .000137768;
        -4.10105e-5;
        -.000641779;
        -.00100234;
        -.00145291;
        -.00165302;
        -.0013441;
        -.00109712;
        -.000739582;
        8.04564e-5;
        .00092454;
        .000736885;
        -.000111052;
        -.00121338;
        -.000909819;
        -.000399861;
        .000442307;
        .0011305;
        -.000571916;
        -.00234916;
        -.00223844;
        -.000779527;
        .000833485;
        .00103313;
        .00066767;
        .000372098;
        .000143728;
        -.000178444;
        -.000766146;
        -.000563359;
        .0023385;
        .00578153;
        .00534012;
        .00127074;
        -.00278905;
        -.00270199;
        .000474827;
        .00284007;
        .00184745;
        -.000847996;
        -.00196087;
        -.000431819;
        .000928657;
        .000188039;
        -.000849638;
        -.00142131;
        -.00104487;
        -.000202783;
        .000101798;
        -.000983555;
        -.002129;
        -.0017525;
        -.00175153;
        -.00153225;
        -.00105932;
        -.00206373;
        -.00192016;
        -.000287726;
        .00253314;
        .00312917;
        -6.26925e-5;
        -.00423696;
        -.00466347;
        -.000793153;
        .00240486;
        .00348852;
        -.00186931;
        -.00586671;
        -.00221895;
        .0026846;
        .00553936;
        .00505997;
        .00246837;
        1.9655e-5;
        .000209576;
        .000843011;
        .00205513;
        .00372395;
        .00345982;
        .00239369;
        -.000789963;
        -.00259737;
        .000306097;
        .00218739;
        .00114734;
        .000238249;
        .000593092;
        -.000477991;
        -.000215173;
        -.00279875;
        -.0046809;
        .00120975;
        .0057256;
        .00289181;
        -.00354204;
        -.00959033;
        -.00760808;
        .00121058;
        .00350675;
        -.00471251;
        -.0111877;
        -.00746588;
        -.00170635;
        .004472;
        .00135775;
        -.00464857;
        -.00785828;
        .000955944;
        .0116417;
        .0070908;
        .00302178;
        -.00382604;
        -.0063242;
        -.00313069;
        .00239066;
        -.00239145;
        -.00881652;
        .00639145;
        .0190516;
        .0181054;
        .0102787;
        .00289175;
        .00726758;
        .0146966;
        .0243146;
        .0147135;
        -.00546896;
        -.0249093;
        -.011667;
        .00808105;
        .000399708;
        .00146356;
        -.0138353;
        -.0128062;
        .0159619;
        .0332372;
        .0148563;
        -.0286008;
        -.0306837;
        .00122938;
        .0131065;
        -.0258396;
        -.036833;
        -.00754758;
        .00674304;
        .00211161;
        -.0385987;
        -.0580986;
        -.0415631;
        .0600245;
        .0905426;
        .0208877;
        .00310079;
        -.00405743;
        -.003119;
        .00378567;
        .00295755;
        -.00433807;
        -.00206177;
        .0037607;
        .00231138;
        -.00384606;
        -.00186582;
        .00386064;
        .00206156;
        -.0026848;
        -.00154734;
        .00286635;
        .0020133;
        -.0017201;
        -.00146433;
        .00119451;
        .0012744;
        -.000733868;
        -.000723758;
        .000940235;
        .00146374;
        8.08543e-5;
        -.000836555;
        -.000359769;
        -.00035376;
        -.000565025;
        -.000335339;
        .000141925;
        .000520101;
        -.000455111;
        -.00195757;
        -.0020002;
        -.000884793;
        -.000546883;
        -.00140221;
        -.00162812;
        -.000431704;
        .000607236;
        .000735106;
        -7.75542e-5;
        -.000294401;
        4.89311e-5;
        .000542398;
        .000230462;
        -.000176214;
        -.00050223;
        .000283302;
        .00086273])';

%% hsin (300 taps)
hsin = flip([.000650706;
        .000532794;
        .000399231;
        .000254221;
        .000101872;
        -5.36642e-5;
        -.000208068;
        -.00035603;
        -.000493931;
        -.00061848;
        -.000725265;
        -.000809793;
        -.000868082;
        -.000898857;
        -.00090214;
        -.000879002;
        -.000830133;
        -.000756751;
        -.000660989;
        -.000545709;
        -.000413843;
        -.000268284;
        -.000113814;
        4.35402e-5;
        .000198475;
        .000347595;
        .000487161;
        .000613803;
        .000723314;
        .000812243;
        .000877231;
        .000915341;
        .000925034;
        .000905686;
        .000859202;
        .000788271;
        .000695441;
        .000582922;
        .000453256;
        .000309149;
        .00015499;
        -5.06302e-6;
        -.000166032;
        -.000322382;
        -.000469177;
        -.00060172;
        -.000715767;
        -.00080893;
        -.000880386;
        -.00092852;
        -.000950674;
        -.000944261;
        -.000908262;
        -.000844008;
        -.000753674;
        -.000639565;
        -.000505128;
        -.000355251;
        -.000194611;
        -2.76822e-5;
        .000142239;
        .000310635;
        .000471928;
        .00062165;
        .000756062;
        .000871449;
        .000963817;
        .00102967;
        .00106683;
        .00107424;
        .00105179;
        .000999814;
        .000920041;
        .000814502;
        .000685159;
        .000534667;
        .000367123;
        .000187238;
        1.6269e-7;
        -.000189304;
        -.000376215;
        -.000555337;
        -.000720277;
        -.000865823;
        -.000987694;
        -.00108247;
        -.00114725;
        -.00117963;
        -.00117829;
        -.00114274;
        -.00107374;
        -.000972836;
        -.000842275;
        -.000685341;
        -.000506602;
        -.000311335;
        -.000105456;
        .000105734;
        .000316594;
        .000520911;
        .000711729;
        .000882695;
        .00102784;
        .00114249;
        .00122245;
        .00126434;
        .00126627;
        .00122836;
        .0011518;
        .00103875;
        .000892805;
        .000717864;
        .000518412;
        .000299745;
        6.81627e-5;
        -.000168409;
        -.000402527;
        -.000626645;
        -.000834196;
        -.00101873;
        -.00117439;
        -.00129524;
        -.00137664;
        -.00141459;
        -.00140697;
        -.00135356;
        -.00125571;
        -.00111669;
        -.00094009;
        -.000730351;
        -.000492714;
        -.000234955;
        3.44368e-5;
        .000306698;
        .000572839;
        .000824783;
        .00105513;
        .00125661;
        .00142229;
        .00154641;
        .00162463;
        .00165416;
        .00163409;
        .0015659;
        .00145133;
        .00129306;
        .0010941;
        .000859742;
        .000596818;
        .00031332;
        1.7286e-5;
        -.000283171;
        -.000580101;
        -.000865106;
        -.00112997;
        -.00136638;
        -.00156689;
        -.00172393;
        -.00183128;
        -.00188503;
        -.00188362;
        -.00182709;
        -.00171622;
        -.00155378;
        -.001344;
        -.00109308;
        -.000809045;
        -.000500006;
        -.000174414;
        .000158923;
        .000489406;
        .000807091;
        .00110358;
        .00137171;
        .00160446;
        .0017937;
        .00193276;
        .0020164;
        .0020426;
        .0020108;
        .00192156;
        .00177561;
        .00157699;
        .00133151;
        .00104588;
        .000727944;
        .000385438;
        2.75027e-5;
        -.000334881;
        -.000689397;
        -.00102542;
        -.00133353;
        -.001605;
        -.00183064;
        -.00200257;
        -.00211469;
        -.00216465;
        -.00214999;
        -.00207016;
        -.001926;
        -.00172198;
        -.00146451;
        -.00116157;
        -.000822408;
        -.000456418;
        -7.46154e-5;
        .000311689;
        .000691613;
        .0010547;
        .00138922;
        .00168441;
        .00193084;
        .00212023;
        .00224619;
        .00230395;
        .00229231;
        .00221061;
        .0020609;
        .00184661;
        .00157429;
        .00125156;
        .00088823;
        .000494164;
        7.99058e-5;
        -.000342103;
        -.000758632;
        -.00115666;
        -.00152453;
        -.00185137;
        -.00212684;
        -.00234161;
        -.00248786;
        -.00256092;
        -.00255821;
        -.00247938;
        -.00232546;
        -.00210032;
        -.00180952;
        -.0014618;
        -.0010674;
        -.000638358;
        -.000187375;
        .000271994;
        .000726058;
        .00116158;
        .00156624;
        .00192799;
        .00223642;
        .00248192;
        .00265621;
        .00275299;
        .00276852;
        .00270211;
        .00255544;
        .00233256;
        .00203953;
        .00168435;
        .00127691;
        .000829261;
        .000354876;
        -.0001327;
        -.000618793;
        -.00108996;
        -.00153183;
        -.00193158;
        -.00227729;
        -.0025577;
        -.00276455;
        -.00289144;
        -.00293474;
        -.00289238;
        -.00276541;
        -.00255575;
        -.0022676;
        -.00190946;
        -.00149287;
        -.001031;
        -.00053762;
        -2.72128e-5;
        .000485632;
        .00098638;
        .00146006;
        .0018929;
        .00227143;
        .00258342;
        .00281799;
        .00296866;
        .00303196;
        .0030063;
        .00289275;
        .00269411;
        .00241576;
        .00206448;
        .0016501;
        .00118416;
        .000679657;
        .000150355;
        -.000387886;
        -.000918558;
        -.00142536])';

%% Plots of hBB
close all

figure(1)
stem(hBB)
title('Filtercoeffs, hBB (300 taps)')

figure(2)
[HBB,w] = freqz(hBB,1,300);
plot(w/pi,abs(HBB))
xlabel('f/(fs/2)')
ylabel('|HBB|')
title('Magnitude, hBB (300 taps)')

figure(3)
plot(w/pi,unwrap(angle(HBB)))
xlabel('f/(fs/2)')
ylabel('Phase of HBB')
title('Phase, HBB (300 taps)')


%% Plots of hsin
close all

figure(1)
stem(hsin)
title('Filter coeffs, hsin (300 taps)')

figure(2)
[Hsin,w] = freqz(hsin,1,300);
plot(w/pi,abs(Hsin))
xlabel('f/(fs/2)')
ylabel('|Hsin|')
title('Magnitude, Hsin (300 taps)')

figure(3)
plot(w/pi,unwrap(angle(Hsin)))
xlabel('f/(fs/2)')
ylabel('Phase of Hsin')
title('Phase, Hsin (300 taps)')











%% Usage guidef
% 
% Usage guide;
% Press the following keys to change the system behavior
%         'd' - LMS filtering disabled, raw microphone data output to left speaker. Initial mode.
%         'f' - LMS filtering applied, update disabled (h held constant, i.e. mu = 0), error signal output to left speaker
%         'u' - LMS filtering applied with filter update, error signal output to left speaker
%         't' - Toggle disturbance source between cosine signal and wide band noise
%         'r' - Reset filter coefficients to 0 and empty logged error output
%         '1' - Increase step size mu
%         '2' - Decrease step size mu
%         '3' - Increase number of used LMS taps (maximum (1024))
%         '4' - Decrease number of used LMS taps (minimum 1, unused taps set to zero)
%         'm' - Prints the filter coefficients h in a format useful for import in Matlab
%         'h' - Plots the current filter coefficients directly in the terminal
%         'e' - Plots the most recent (15) seconds of the LMS filter error output
%         's' - Toggles music signal